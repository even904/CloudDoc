---
author: [Even]
date: [2025年11月08日]
update: [2025年11月08日]
title: [【计算机网络】5 网络层：控制平面]
tags: [计算机网络, 网络层, 控制平面]
---

# 5 网络层：控制平面
## 5.1 导论
- 网络层两个重要功能
    - 转发：将分组从路由器的一个输入端口转移到一个合适的输出端口（数据平面）
    - 路由：确定分组从源到目标的路径（控制平面）
        - 传统方式
        - SDN方式-逻辑分离-远程-南向接口-代理（CA）
## 5.2 路由选择算法
- 路由：按照某种指标（传输延迟、所经过的站点数目等）找到一条从源节点到目标节点的较好路径
- 路由器-路由器之间的最优路径 = 主机对之间的最优路径
- 路由选择算法（routing algorithm）：网络层软件的一部分，完成路由功能
    - LS：传的分组多，收敛快，健壮性好
    - DV：传的分组少，收敛慢，健壮性差（某节点宣称到所有其它节点代价均为0）
- 最优化原则
    - 汇集树(sink tree)
        - 此节点到所有其他节点的最优路径形成的树
        - 路由选择算法就是为所有路由器找到并使用汇集树
- 路由的原则
    - 正确性：正确、完整
    - 简单性：代价小
    - 健壮性：适应通信量、网络拓扑变化
- link state(Dijkstra)
    - 工作过程
        - 获得整个网络拓扑，代价信息
        - 使用LS路由算法计算最优路径
    - 具体细节
        - 发现相邻节点，获知对方网络地址
        - 测量到相邻节点的代价（延迟、开销）
        - 组装一个LS分组，描述相邻节点的情况
        - 将分组通过扩散的方法发到所有其它路由器
        - 通过Dijkstra算法找出最短路径
    - 链路状态分组泛洪，通过顺序号防止环内循环泛洪冲击
    - 目标是让所有其他节点都收到其他节点的链路状态分组
    - 应用
        - OSPF协议是一种LS协议
        - IS-IS(intermediate system-intermediate system)被用于Internet主干中，Netware
    - Dijkstra算法（O(N*N)）例子[<进度42min>](https://www.bilibili.com/video/BV1JV411t7ow?spm_id_from=333.788.videopod.episodes&vd_source=c8ac73e73c815dd8cb578fb7b85febcf&p=35)
        - 分为已标记节点和其他节点（临时节点）
        - 从临时节点中抓出最小代价节点标记到已标记节点
        - 节点描述(代价，前继)
        - 初始化时未知，代价即为无限大
    - 拥塞路径切换导致的震荡
- Distance vector routing(距离矢量路由选择)
    - DV算法历史及应用
        - 1957 Bellman, 1962 Ford Fulkerson(B-F方程)
        - 用于ARPANET, Internet(RIP), DECnet, Novell, ApplTalk
    - 基本思想
        - 各路由器维护一张路由表
        - 各路由器与相邻路由器交换路由表
        - 根据获得的路由信息，更新路由表
    - DV例子1[<进度1h06min>](https://www.bilibili.com/video/BV1JV411t7ow?spm_id_from=333.788.videopod.episodes&vd_source=c8ac73e73c815dd8cb578fb7b85febcf&p=35)
    - 异步迭代，分布计算：代价变化/邻居传来的更新触发
    - 好消息传的快，坏消息传的慢：断路信息可能形成环路
        - 解决：水平分裂算法：上一跳为“谦虚值”，下一跳为“虚假值”，逐次交换迭代直到达到各节点明白上级断路的共识
## 5.3 自治系统内部的路由选择

- RIP（Routing Information Protocol）协议
    - Dsitance vector算法
        - 每条链路cost=1 # of hops(max = 15 hops)跳数
        - DV每隔30s和邻居交换DV，通告（定期触发/请求触发）
        - 每个通告包括：最多25个目标子网
        - 180s未收到通告，则认为链路失效
    - 守护进程实现网络层功能，传输层使用UDP协议
- OSPF（Open Shortest Path First）
    - 标准开放可获取
    - LS算法
    - 路由计算Dijkstra算法
    - 安全：所有报文经过认证
    - 支持多重代价矩阵
    - Multicast OSPF
    - 层次化OSPF路由
        - 区域边界路由（连通处分别参与路由计算）
        - 骨干路由器
        - 边界路由器
- IS-IS路由协议：几乎和OSPF一样

## 5.6 总结
- 路由选择算法
    - link state
    - distance vector
- 因特网中自治系统的路由选择
    - RIP
    - OSPF
- ISP之间的路由选择
    - BGP
- SDN控制平面
- ICMP：因特网控制报文协议
- 网络管理和SNMP
